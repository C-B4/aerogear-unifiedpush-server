create table if not exists documents (push_application_id uuid, database text, user_id timeuuid, snapshot timeuuid, document_id text, content text, content_type text, PRIMARY KEY ((push_application_id, database, user_id), snapshot)) WITH CLUSTERING ORDER BY (snapshot DESC);
create custom index if not exists idx_documents_id ON documents (document_id) USING 'org.apache.cassandra.index.sasi.SASIIndex' WITH OPTIONS = { 'mode': 'CONTAINS', 'analyzer_class': 'org.apache.cassandra.index.sasi.analyzer.NonTokenizingAnalyzer', 'case_sensitive': 'false' };
create table if not exists databases (push_application_id uuid, snapshot timestamp, database text, PRIMARY KEY (push_application_id, snapshot)) WITH CLUSTERING ORDER BY (snapshot DESC);
create custom index if not exists idx_databases_database ON databases (database) USING 'org.apache.cassandra.index.sasi.SASIIndex' WITH OPTIONS = { 'mode': 'CONTAINS', 'analyzer_class': 'org.apache.cassandra.index.sasi.analyzer.NonTokenizingAnalyzer', 'case_sensitive': 'false' };
create table if not exists users (push_application_id uuid, id timeuuid, month tinyint, day int, email text, mobile text, PRIMARY KEY (push_application_id, id));
create custom index if not exists idx_users_email ON users (email) USING 'org.apache.cassandra.index.sasi.SASIIndex' WITH OPTIONS = { 'mode': 'CONTAINS', 'analyzer_class': 'org.apache.cassandra.index.sasi.analyzer.NonTokenizingAnalyzer', 'case_sensitive': 'false' };
create custom index if not exists idx_users_mobile ON users (mobile) USING 'org.apache.cassandra.index.sasi.SASIIndex' WITH OPTIONS = { 'mode': 'CONTAINS', 'analyzer_class': 'org.apache.cassandra.index.sasi.analyzer.NonTokenizingAnalyzer', 'case_sensitive': 'false' };
create materialized view if not exists users_by_application as select month from users where push_application_id IS NOT NULL AND id IS NOT NULL and month IS NOT NULL PRIMARY KEY ((push_application_id, month), id) WITH CLUSTERING ORDER BY (id DESC);